import{j as e,e as t,v as I,L as Q,r as T,S as _,f as M}from"./index-kaEKLpWB.js";import{u as E,i as W,e as X,f as Y,g as ee}from"./Layout-XJLSbV9V.js";import{u as L}from"./useAsync-9cJkpmkv.js";import{u as V,M as H}from"./DrawerButton-fnQ8qkSd.js";import{U as se}from"./UploadManyTwo-Conyd6VG.js";import{N as te}from"./NotFound-3_tl_3Mc.js";import{a as le,P as U,c as ae,r as re,u as ie,C as ne}from"./ProductServices-Rz27ds4X.js";import{P as oe}from"./PageTitle-uhVa4RAW.js";import{P as $}from"./ProductDrawer-FLO8hspG.js";import{C as q,S as de,B as ce}from"./BulkActionDrawer-BTJIHzVi.js";import{D as Z,E as xe}from"./EditDeleteButton--eCAtp8b.js";import{T as me}from"./Tooltip-tqve1L36.js";import{n as F,a as R}from"./toast-33DDocbW.js";import{T as ge}from"./TableLoading-qOnfK9mv.js";import"./iconBase-SdznC8D3.js";import"./useDispatch-bCGmUp1F.js";import"./SelectLanguageTwo-yftg4yHI.js";import"./LanguageServices-hLaudBO3.js";import"./spinner-R50PTWTV.js";import"./exportFromJSON-YB29QCxh.js";import"./index-B-QvMZsz.js";import"./index-gDMIBens.js";import"./ParentCategory-GAgzQS_4.js";import"./index.esm-UHEZOc8y.js";import"./InputArea-6bVCC4zo.js";import"./LabelArea-0V6LeSph.js";import"./InputValue-PAVuJz8D.js";import"./Uploader-cS0uZHKZ.js";import"./tslib.es6-YYMLUA4o.js";import"./index.prod-QLvVMLGD.js";import"./CurrencyServices-Pic61tjR.js";import"./SwitchToggle-Cy2HBZ9n.js";import"./AdminServices-Qg-G-GcP.js";const he=({products:p,isCheck:n,setIsCheck:g})=>{const{title:C,serviceId:m,handleModalOpen:a,handleUpdate:b}=V(),{currency:f,showingTranslateValue:j,getNumberTwo:u}=E(),y=s=>{const{id:w,checked:N}=s.target;g([...n,w]),N||g(n.filter(S=>S!==w))};return e.jsxs(e.Fragment,{children:[(n==null?void 0:n.length)<1&&e.jsx(Z,{id:m,title:C}),(n==null?void 0:n.length)<2&&e.jsx(H,{children:e.jsx($,{currency:f,id:m})}),e.jsx(t.TableBody,{children:p==null?void 0:p.map((s,w)=>{var N,S,v,P,c,l,i;return e.jsxs(t.TableRow,{children:[e.jsx(t.TableCell,{children:e.jsx(q,{type:"checkbox",name:(N=s==null?void 0:s.title)==null?void 0:N.en,id:s._id,handleClick:y,isChecked:n==null?void 0:n.includes(s._id)})}),e.jsx(t.TableCell,{children:e.jsxs("div",{className:"flex items-center",children:[s!=null&&s.image[0]?e.jsx(t.Avatar,{className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none",src:s==null?void 0:s.image[0],alt:"product"}):e.jsx(t.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product"}),e.jsx("div",{children:e.jsx("h2",{className:`text-sm font-medium ${(s==null?void 0:s.title.length)>30?"wrap-long-title":""}`,children:(S=j(s==null?void 0:s.title))==null?void 0:S.substring(0,28)})})]})}),e.jsx(t.TableCell,{children:e.jsx("span",{className:"text-sm",children:j((v=s==null?void 0:s.category)==null?void 0:v.name)})}),e.jsx(t.TableCell,{children:e.jsxs("span",{className:"text-sm font-semibold",children:[f,s!=null&&s.isCombination?u((P=s==null?void 0:s.variants[0])==null?void 0:P.originalPrice):u((c=s==null?void 0:s.prices)==null?void 0:c.originalPrice)]})}),e.jsx(t.TableCell,{children:e.jsxs("span",{className:"text-sm font-semibold",children:[f,s!=null&&s.isCombination?u((l=s==null?void 0:s.variants[0])==null?void 0:l.price):u((i=s==null?void 0:s.prices)==null?void 0:i.price)]})}),e.jsx(t.TableCell,{children:e.jsx("span",{className:"text-sm",children:s.stock})}),e.jsx(t.TableCell,{children:s.stock>0?e.jsx(t.Badge,{type:"success",children:I("Selling")}):e.jsx(t.Badge,{type:"danger",children:I("SoldOut")})}),e.jsx(t.TableCell,{children:e.jsx(Q,{to:`/product/${s._id}`,className:"flex justify-center text-gray-400 hover:text-emerald-600",children:e.jsx(me,{id:"view",Icon:W,title:I("DetailsTbl"),bgColor:"#10B981"})})}),e.jsx(t.TableCell,{className:"text-center",children:e.jsx(de,{id:s._id,status:s.status})}),e.jsx(t.TableCell,{children:e.jsx(xe,{id:s._id,product:s,isCheck:n,handleUpdate:b,handleModalOpen:a,title:j(s==null?void 0:s.title)})})]},w+1)})})]})},pe={type:"object",properties:{categories:{type:"array"},image:{type:"array"},tag:{type:"array"},variants:{type:"array"},show:{type:"array"},status:{type:"string"},prices:{type:"object"},isCombination:{type:"boolean"},title:{type:"object"},productId:{type:"string"},slug:{type:"string"},category:{type:"object"},stock:{type:"number"},description:{type:"object"}},required:["categories","category","prices","title"]},je=p=>{const n=new le({allErrors:!0}),{setLoading:g,setIsUpdate:C}=T.useContext(_),[m]=T.useState([]),[a,b]=T.useState([]),[f,j]=T.useState(""),[u,y]=T.useState(!1);return{data:p,filename:f,isDisabled:u,handleSelectFile:async c=>{var D;c.preventDefault();const l=new FileReader,i=(D=c.target)==null?void 0:D.files[0];if(i&&i.type==="application/json")j(i==null?void 0:i.name),y(!0),l.readAsText(i,"UTF-8"),l.onload=d=>{const h=JSON.parse(d.target.result).map(r=>({categories:r.categories,image:r.image,barcode:r.barcode,tag:r.tag,variants:r.variants,status:r.status,prices:r.prices,isCombination:r.isCombination,title:r.title,productId:r.productId,slug:r.slug,sku:r.sku,category:r.category,stock:r.stock,description:r.description}));b(h)};else if(i&&i.type==="text/csv")j(i==null?void 0:i.name),y(!0),l.onload=async d=>{const A=d.target.result,r=(await ae().fromString(A)).map(o=>({categories:JSON.parse(o.categories),image:JSON.parse(o.image),barcode:o.barcode,tag:JSON.parse(o.tag),variants:JSON.parse(o.variants),status:o.status,prices:JSON.parse(o.prices),isCombination:JSON.parse(o.isCombination),title:JSON.parse(o.title),productId:o.productId,slug:o.slug,sku:o.sku,category:JSON.parse(o.category),stock:JSON.parse(o.stock),description:JSON.parse(o.description)}));b(r)},l.readAsText(i);else{j(i==null?void 0:i.name),y(!0);const d=!!l.readAsBinaryString;l.onload=function(A){const h=A.target.result,r=re(h,{type:d?"binary":"array",bookVBA:!0}),o=r.SheetNames[0],O=r.Sheets[o],B=ie.sheet_to_json(O).map(x=>({categories:JSON.parse(x.categories),image:JSON.parse(x.image),barcode:x.barcode,tag:JSON.parse(x.tag),variants:JSON.parse(x.variants),status:x.status,prices:JSON.parse(x.prices),isCombination:JSON.parse(x.isCombination),title:JSON.parse(x.title),productId:x.productId,slug:x.slug,sku:x.sku,category:JSON.parse(x.category),stock:JSON.parse(x.stock),description:JSON.parse(x.description)}));b(B)},d?l.readAsBinaryString(i):l.readAsArrayBuffer(i)}},serviceData:p,handleOnDrop:c=>{for(let l=0;l<c.length;l++)m.push(c[l].data)},handleUploadProducts:()=>{m.length<1?F("Please upload/select csv file first!"):U.addAllProducts(m).then(c=>{R(c.message)}).catch(c=>F(c.message))},handleRemoveSelectFile:c=>{j(""),b([]),setTimeout(()=>y(!1),1e3)},handleUploadMultiple:c=>{if(a.length>1){g(!0);let l=a.map(d=>n.validate(pe,d));const i=d=>d===!0;l.every(i)?U.addAllProducts(a).then(d=>{C(!0),g(!1),R(d.message)}).catch(d=>{g(!1),F(d.message)}):(g(!1),F("Please enter valid data!"))}else g(!1),F("Please select a valid json, csv & xls file first!")}}},be=({setCategory:p})=>{const{t:n}=M(),{data:g}=L(ne.getAllCategories),{showingTranslateValue:C}=E();return e.jsx(e.Fragment,{children:e.jsxs(t.Select,{onChange:m=>p(m.target.value),children:[e.jsx("option",{value:"All",defaultValue:!0,hidden:!0,children:n("Category")}),g==null?void 0:g.map(m=>e.jsx("option",{value:m._id,children:C(m==null?void 0:m.name)},m._id))]})})},We=()=>{const{title:p,allId:n,serviceId:g,handleDeleteMany:C,handleUpdateMany:m}=V(),{t:a}=M(),{toggleDrawer:b,lang:f,currentPage:j,handleChangePage:u,searchText:y,category:s,setCategory:w,searchRef:N,handleSubmitForAll:S,sortedField:v,setSortedField:P,limitData:c}=T.useContext(_),{data:l,loading:i,error:D}=L(()=>U.getAllProducts({page:j,limit:c,category:s,title:y,price:v})),[d,A]=T.useState(!1),[h,r]=T.useState([]),o=()=>{A(!d),r(l==null?void 0:l.products.map(J=>J._id)),d&&r([])},O=()=>{w(""),P(""),N.current.value=""},{serviceData:k,filename:B,isDisabled:x,handleSelectFile:z,handleUploadMultiple:G,handleRemoveSelectFile:K}=je(l==null?void 0:l.products);return e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:a("ProductsPage")}),e.jsx(Z,{ids:n,setIsCheck:r,title:p}),e.jsx(ce,{ids:n,title:"Products"}),e.jsx(H,{children:e.jsx($,{id:g})}),e.jsx(t.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 mb-5",children:e.jsx(t.CardBody,{className:"",children:e.jsxs("form",{onSubmit:S,className:"py-3 md:pb-0 grid gap-4 lg:gap-6 xl:gap-6 xl:flex",children:[e.jsx("div",{className:"flex-grow-0 sm:flex-grow md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(se,{title:"Products",filename:B,isDisabled:x,totalDoc:l==null?void 0:l.totalDoc,handleSelectFile:z,handleUploadMultiple:G,handleRemoveSelectFile:K})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Button,{disabled:h.length<1,onClick:()=>m(h),className:"w-full rounded-md h-12 btn-gray text-gray-600",children:[e.jsx("span",{className:"mr-2",children:e.jsx(X,{})}),a("BulkAction")]})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Button,{disabled:(h==null?void 0:h.length)<1,onClick:()=>C(h,l.products),className:"w-full rounded-md h-12 bg-red-300 disabled btn-red",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Y,{})}),a("Delete")]})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Button,{onClick:b,className:"w-full rounded-md h-12",children:[e.jsx("span",{className:"mr-2",children:e.jsx(ee,{})}),a("AddProduct")]})})]})]})})}),e.jsx(t.Card,{className:"min-w-0 shadow-xs overflow-hidden bg-white dark:bg-gray-800 rounded-t-lg rounded-0 mb-4",children:e.jsx(t.CardBody,{children:e.jsxs("form",{onSubmit:S,className:"py-3 grid gap-4 lg:gap-6 xl:gap-6 md:flex xl:flex",children:[e.jsxs("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx(t.Input,{ref:N,type:"search",name:"search",placeholder:"Search Product"}),e.jsx("button",{type:"submit",className:"absolute right-0 top-0 mt-5 mr-1"})]}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsx(be,{setCategory:w,lang:f})}),e.jsx("div",{className:"flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:e.jsxs(t.Select,{onChange:J=>P(J.target.value),children:[e.jsx("option",{value:"All",defaultValue:!0,hidden:!0,children:a("Price")}),e.jsx("option",{value:"low",children:a("LowtoHigh")}),e.jsx("option",{value:"high",children:a("HightoLow")}),e.jsx("option",{value:"published",children:a("Published")}),e.jsx("option",{value:"unPublished",children:a("Unpublished")}),e.jsx("option",{value:"status-selling",children:a("StatusSelling")}),e.jsx("option",{value:"status-out-of-stock",children:a("StatusStock")}),e.jsx("option",{value:"date-added-asc",children:a("DateAddedAsc")}),e.jsx("option",{value:"date-added-desc",children:a("DateAddedDesc")}),e.jsx("option",{value:"date-updated-asc",children:a("DateUpdatedAsc")}),e.jsx("option",{value:"date-updated-desc",children:a("DateUpdatedDesc")})]})}),e.jsxs("div",{className:"flex items-center gap-2 flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsx("div",{className:"w-full mx-1",children:e.jsx(t.Button,{type:"submit",className:"h-12 w-full bg-emerald-700",children:"Filter"})}),e.jsx("div",{className:"w-full mx-1",children:e.jsx(t.Button,{layout:"outline",onClick:O,type:"reset",className:"px-4 md:py-1 py-2 h-12 text-sm dark:bg-gray-700",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Reset"})})})]})]})})}),i?e.jsx(ge,{row:12,col:7,width:160,height:20}):D?e.jsx("span",{className:"text-center mx-auto text-red-500",children:D}):(k==null?void 0:k.length)!==0?e.jsxs(t.TableContainer,{className:"mb-8 rounded-b-lg",children:[e.jsxs(t.Table,{children:[e.jsx(t.TableHeader,{children:e.jsxs("tr",{children:[e.jsx(t.TableCell,{children:e.jsx(q,{type:"checkbox",name:"selectAll",id:"selectAll",isChecked:d,handleClick:o})}),e.jsx(t.TableCell,{children:a("ProductNameTbl")}),e.jsx(t.TableCell,{children:a("CategoryTbl")}),e.jsx(t.TableCell,{children:a("PriceTbl")}),e.jsx(t.TableCell,{children:"Sale Price"}),e.jsx(t.TableCell,{children:a("StockTbl")}),e.jsx(t.TableCell,{children:a("StatusTbl")}),e.jsx(t.TableCell,{className:"text-center",children:a("DetailsTbl")}),e.jsx(t.TableCell,{className:"text-center",children:a("PublishedTbl")}),e.jsx(t.TableCell,{className:"text-right",children:a("ActionsTbl")})]})}),e.jsx(he,{lang:f,isCheck:h,products:l==null?void 0:l.products,setIsCheck:r})]}),e.jsx(t.TableFooter,{children:e.jsx(t.Pagination,{totalResults:l==null?void 0:l.totalDoc,resultsPerPage:c,onChange:u,label:"Product Page Navigation"})})]}):e.jsx(te,{title:"Product"})]})};export{We as default};
