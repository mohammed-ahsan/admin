import{d as p}from"./Layout-XJLSbV9V.js";import{r as n,A as F,S as R,h as V,d as q}from"./index-kaEKLpWB.js";import{u as z}from"./index.esm-UHEZOc8y.js";import{A as S}from"./AdminServices-Qg-G-GcP.js";import{a as E,n as A}from"./toast-33DDocbW.js";const P=i=>{const{state:C}=n.useContext(F),{adminInfo:D}=C,{isDrawerOpen:d,closeDrawer:l,setIsUpdate:h,lang:w}=n.useContext(R),[Y,f]=n.useState(""),[u,y]=n.useState(p(new Date).format("YYYY-MM-DD")),[r,b]=n.useState(w||"en"),[j,x]=n.useState({}),[L,c]=n.useState(!1),I=V(),{register:U,handleSubmit:O,setValue:a,clearErrors:o,formState:{errors:k}}=z(),v=async t=>{var m,e;try{c(!0);const s={name:{[r]:t.name},email:t.email,password:t.password,phone:t.phone,role:t.role,joiningDate:u||p(new Date).format("YYYY-MM-DD"),image:Y,lang:r};if(i){const g=await S.updateStaff(i,s);h(!0),c(!1),E(g.message),l()}else{const g=await S.addStaff(s);h(!0),c(!1),E(g.message),l()}}catch(s){A(s?(e=(m=s==null?void 0:s.response)==null?void 0:m.data)==null?void 0:e.message:s==null?void 0:s.message),c(!1),l()}},M=async()=>{var t,m;try{const e=await S.getStaffById(i,{email:D.email});e&&(x(e),a("name",e.name[r||"en"]),a("email",e.email),a("password"),a("phone",e.phone),a("role",e.role),y(p(e.joiningData).format("YYYY-MM-DD")),f(e.image))}catch(e){A(e?(m=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:m.message:e==null?void 0:e.message)}},B=t=>{b(t),Object.keys(j).length>0&&a("name",j.name[t||"en"])};return n.useEffect(()=>{if(!d){x({}),a("name"),a("email"),a("password"),a("phone"),a("role"),a("joiningDate"),f(""),o("name"),o("email"),o("password"),o("phone"),o("role"),o("joiningDate"),f(""),b(w),a("language",r);return}i&&M()},[i,a,d,D.email,o]),n.useEffect(()=>{I.pathname==="/edit-profile"&&q.get("adminInfo")&&M()},[I.pathname,a]),{register:U,handleSubmit:O,onSubmit:v,language:r,errors:k,setImageUrl:f,imageUrl:Y,selectedDate:u,setSelectedDate:y,isSubmitting:L,handleSelectLanguage:B}};export{P as u};
