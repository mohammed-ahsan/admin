import{r as d,A as O,m as E,h as I,n as R,d as S}from"./index-kaEKLpWB.js";import{u as v}from"./index.esm-UHEZOc8y.js";import{A as i}from"./AdminServices-Qg-G-GcP.js";import{a as n,n as m}from"./toast-33DDocbW.js";import{u as C}from"./useDispatch-bCGmUp1F.js";const w=()=>{const l=C(),[h,e]=d.useState(!1),{dispatch:c}=d.useContext(O),f=E(),o=I(),{register:y,handleSubmit:x,formState:{errors:A}}=v();return{onSubmit:({name:L,email:p,verifyEmail:N,password:u,role:b})=>{e(!0);const g=.5;o.pathname==="/login"&&(l(R("globalSetting")),i.loginAdmin({email:p,password:u}).then(s=>{s&&(e(!1),n("Login Success!"),c({type:"USER_LOGIN",payload:s}),S.set("adminInfo",JSON.stringify(s),{expires:g,sameSite:"None",secure:!0}),f.replace("/"))}).catch(s=>{var t,a;m(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message)),e(!1)})),o.pathname==="/signup"&&i.registerAdmin({name:L,email:p,password:u,role:b}).then(s=>{s&&(e(!1),n("Register Success!"),c({type:"USER_LOGIN",payload:s}),S.set("adminInfo",JSON.stringify(s),{expires:g,sameSite:"None",secure:!0}),f.replace("/"))}).catch(s=>{var t,a;m(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message)),e(!1)}),o.pathname==="/forgot-password"&&i.forgetPassword({verifyEmail:N}).then(s=>{e(!1),n(s.message)}).catch(s=>{var t,a;e(!1),m(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||(s==null?void 0:s.message))})},register:y,handleSubmit:x,errors:A,loading:h}};export{w as u};
